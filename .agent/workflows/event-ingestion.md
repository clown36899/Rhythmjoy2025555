---
description: 인스타그램 및 네이버를 통한 이벤트 포스터 정밀 수집 및 데이터 파싱 절차
---

# 이벤트 정밀 수집 워크플로우 (Event Ingestion Recipe)

> [!IMPORTANT]
> **핵심 검색 원칙 (3계명)**
> 1. **네이버 직접 검색**: 네이버 카페, 블로그 등의 데이터는 반드시 **네이버(naver.com) 엔진에서 직접 검색**합니다. (구글에서 site:naver.com 금지)
> 2. **검색 순서 엄수**: 모든 키워드에 대해 **구글 검색을 완벽히 끝낸 후**, 네이버 검색을 진행합니다.
> 3. **후행 중복 검사**: 모든 플랫폼(구글, 네이버 등)의 검색 결과가 모두 확보된 후, **최종 단계에서 일괄적으로 중복 검사**를 수행합니다.

이 워크플로우는 소셜 미디어(인스타그램, 네이버 등)에서 이벤트 정보를 고화질로 수집하고 정보를 구조화하여 `EventIngestor` 시스템에 전달하는 표준 절차를 정의합니다.

## 1. 수집 준비 (Preparation)
- **키워드 명단**: `src/data/scraped_events.json`의 기존 키워드를 참고하거나 사용자가 제공하는 새로운 카테고리 명단을 확인합니다.
- **검색 키워드 원칙**: 검색어 구성 시 반드시 `src/data/scraped_keywords.json`의 `search_keywords` 필드에 정의된 단어(**dj**, **소셜**)만 사용해야 합니다. **임의로 단어(예: 파티, 일정 등)를 추가하거나 변경하는 것을 엄격히 금지합니다.**
- **검색 및 진입 원칙**: 특정 플랫폼(예: `site:instagram.com`)에 국한하여 검색하지 말고, **구글/네이버에서 키워드를 일반 검색**합니다. 검색 결과 중 인스타그램 게시물이나 공식 채널이 발견되면 해당 URL로 직접 진입하여 정보를 수집합니다.
- **플랫폼별 검색 엔진 준수**: 
    - **구글(Google)**: 인스타그램, 페이스북, 일반 웹페이지 검색에 사용합니다.
    - **네이버(Naver)**: 네이버 카페, 네이버 블로그 검색 시 **반드시 네이버 엔진을 직접 사용**합니다. (구글에서 site:naver.com 검색 절대 금지)
- **검색 순서 및 일괄 중복 검사**: 
    - 반드시 **구글에서의 모든 키워드 검색을 완료한 후, 네이버 검색을 진행**합니다. 
    - 플랫폼별로 개별 중복 검사를 하지 않으며, **모든 검색 결과(구글+네이버)가 확보된 최종 단계에서 일괄적으로 중복 검사**를 수행합니다.
- **필터링 규칙**: 검색어에 날짜를 넣는 대신, **검색 엔진의 기간 설정(Custom Range) 기능**을 사용하여 **오늘(2026-02-17)부터 향후 3주간**의 게시물 또는 관련 콘텐츠가 검색되도록 필터를 적용합니다.
    - **구글**: '도구 > 전체 기간 > 기간 지정'에서 현재 날짜 기준 범위를 설정합니다.
    - **네이버**: '옵션 > 기간 > 직접입력'을 통해 오늘부터 3주간의 데이터를 포함할 수 있는 기간을 설정합니다.
- **주의사항**: `src/data/scraped_keywords.json` 등의 키워드 정의 문서는 **사용자의 명시적 동의 없이 절대 편집하거나 수정할 수 없습니다.**

## 2. 정밀 수집 5단계 공정 (Precise Scraping Process)
단순 검색 결과 썸네일 수집 대신 아래의 정밀 공정을 준수해야 합니다.

1. **URL 직접 접속**: 구글 썸네일 캡처를 금지하고, 실제 게시물 URL(`instagram.com/p/...`)로 직접 진입합니다.
2. **환경 정돈**: 진입 후 나타나는 로그인 권유 팝업이나 모달을 즉시 제거(Click x:659, y:250 등)하여 시야를 확보합니다.
3. **요소(Element) 기반 캡처**: 전체 화면 캡처가 아닌, 포스터 이미지가 담긴 `div`나 `img` 요소를 식별하여 정밀하게 크롭(CaptureByElementIndex)합니다.
4. **상세 정보 파싱**: 우측 캡션 영역에서 아래 데이터를 구조화하여 추출합니다.
    - **행사 일자**: YYYY-MM-DD 형식 및 요일
    - **DJ 명단**: 출연 DJ들을 배열 형식으로 추출
    - **운영 시간**: 시작 및 종료 시간
    - **상태 및 가격**: 정상 운영 여부(Social Open, CLOSED 등) 및 입장료
    - **특이사항**: 설 연휴 휴무, 장소 변경 등 비고 항목
5. **파일 동기화**: 크롭된 이미지는 `public/scraped/[keyword]_poster.png`로 저장하고, 이미지 경로는 웹 경로(`/scraped/...`)로 기록합니다.

## 3. 데이터 업데이트 및 저장 (Data Sync)
- 수집된 정보를 `src/data/scraped_events.json` 형식에 맞춰 업데이트합니다.
- **필수 필드**: `id`, `keyword`, `poster_url`, `structured_data`, `source_url`.
- **중복 검사**: 수집된 데이터의 날짜와 제목이 기존 DB(`useEvents` 훅 참조)에 있는지 대조합니다.

## 4. 최종 검증 (Verification)
- 관리자 페이지 `http://localhost:5173/admin/ingestor`를 열어 아래 사항을 확인합니다.
    - 포스터 이미지가 찌그러짐 없이(`object-fit: contain`) 표시되는지.
    - 'CLOSED' 상태인 항목이 빨간색으로 시각화되는지.
    - 중복 항목에 'DUPLICATE' 배지가 정상 노출되는지.

---
// turbo
**실행 가이드**: 사용자가 "Event Ingestion Recipe  가이드에 따라서 3주치 이벤트 수집 시작해" 또는 "Event Ingestion Recipe 가이드에 따라서 수집 명단대로 긁어줘"라고 말하면 이 워크플로우를 즉시 로드하여 1단계부터 수행합니다.