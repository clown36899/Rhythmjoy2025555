---
description: 빌보드 키오스크 모드 운영 정책 및 자동 업데이트 로직 가이드
---

# 빌보드 키오스크 모드(Billboard Kiosk Mode) 운영 정책

빌보드 페이지(`/billboard/`)는 무인 광고판 전용 키오스크로 운영되며, 앱의 다른 부분과 완전히 격리된 독립적인 실행 환경을 유지해야 합니다. **향후 어떠한 최적화나 기능 추가 시에도 빌보드에는 간섭하지 않는 것을 원칙으로 합니다.**

## 1. 핵심 격리 정책 (Isolation Policy)

빌보드는 사용자 상호작용이 불가능한 환경이므로, 브라우저가 제공하는 대화형 요소 및 캐시 시스템으로부터 수동적으로 보호됩니다.

- **서비스 워커(Service Worker) 차단**: `index.html` 로드 시 빌보드 경로에서는 서비스 워커를 등록하지 않습니다. 이는 오프라인 캐시로 인한 업데이트 지연과 서비스 워커 관련 팝업 발생을 원본 차단하기 위함입니다.
- **상호작용 UI 비활성화**:
  - **업데이트 토스트(SW Update Toast)**: 새 버전 알림 팝업 출력을 차단합니다.
  - **구글 번역(Google Translate)**: 번역 바 및 팝업 안내 출력을 초기화 단계에서 차단합니다.
- **전역 스타일 제약 해제**: 빌보드는 650px 너비 제한을 무시하고 브라우저 전체 화면(100vw)을 사용합니다. (`layout-wide-mode` 적용)

## 2. 자동 업데이트 기술 (Silent Auto-Reload)

빌보드는 수동 조작 없이 항상 최신 상태를 유지하기 위해 다음의 배포 감지 시스템을 사용합니다.

- **Supabase Realtime 동기화**: `page.tsx` 내에서 Supabase의 `deployments` 및 `billboard_user_settings` 테이블을 실시간 구독합니다.
- **자동 새로고침(Silent Reload)**:
  - 새로운 배포(Deployment) 정보가 DB에 인서트되면, 빌보드는 즉시 `window.location.reload()`를 실행하여 최신 코드를 불러옵니다.
  - 데이터(이벤트/설정) 변경 시에는 슬라이드 한 주기가 끝나는 시점에 백그라운드에서 데이터를 갱신합니다.
- **워치독(Watchdog)**: 시스템 이상으로 슬라이드 전환이 15분 이상 멈출 경우, 안전장치로 자동 새로고침을 수행합니다.

## 3. 개발 및 유지보수 규칙

빌보드의 안정성을 유지하기 위해 다음 규칙을 준수해야 합니다.

1. **전역 스크립트 수정 시 주의**: `index.html`의 전역 스크립트에 기능을 추가할 때, 반드시 빌보드 경로 여부를 체크하여 빌보드에서는 실행되지 않도록 예외 처리해야 합니다.
2. **이미지 스케일링 유지**: 이미지는 항상 `object-fit: contain`을 사용하여 비율이 깨지거나 잘리지 않도록 유지하며, 배경은 검은색(#000)으로 고정합니다.
3. **상호작용 금지**: 빌보드 페이지 내에는 버튼, 입력창 등 사용자의 직접적인 터치를 유발하는 요소를 추가하지 않습니다. (QR 코드는 터치용이 아닌 모바일 스캔용입니다.)

> [!IMPORTANT]
> 빌보드 페이지는 "안정성"이 최우선입니다. 새로운 전역 라이브러리나 최적화 도구를 도입할 때 빌보드 페이지의 렌더링이나 자동 갱신 로직에 영향을 주지 않는지 반드시 검토하십시오.
